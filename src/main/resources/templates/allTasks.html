<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task List</title>

    <!-- bootstrap cdn -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    ></script>

    <style>
      body {
        background: #121212;
        color: #e0e0e0;
        font-family: "Segoe UI", sans-serif;
      }

      h1 {
        font-weight: 600;
      }

      .card {
        border: none;
        border-radius: 1rem;
      }

      .table-dark {
        border-radius: 0.5rem;
        overflow: hidden;
      }

      .btn {
        border-radius: 0.5rem;
      }

      .btn-primary {
        background: linear-gradient(45deg, #007bff, #00bfff);
        border: none;
      }

      .btn-primary:hover {
        background: linear-gradient(45deg, #0056b3, #0099cc);
      }

      .badge {
        font-size: 0.85rem;
        padding: 0.5em 0.75em;
      }

      .alert {
        border-radius: 0.75rem;
      }

      /* Add a hover effect for rows */
      tbody tr:hover {
        background-color: #1f1f1f !important;
      }
    </style>
  </head>
  <body>
    <div class="container my-5">
      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>ðŸ“Œ Task List</h1>
        <a th:href="@{/fileUpload}" class="btn btn-outline-info"
          >ðŸ“‚ Upload File</a
        >
      </div>

      <!-- Add Task Form -->
      <div class="card mb-4 bg-dark shadow-lg">
        <div class="card-body">
          <form
            th:action="@{/tasks/add}"
            method="post"
            class="row g-3 align-items-center"
          >
            <div class="col-md-5">
              <input
                type="text"
                name="content"
                class="form-control bg-dark text-light border-light"
                placeholder="Enter new task..."
                required
              />
            </div>
            <div class="col-md-4">
              <input
                type="date"
                name="date"
                class="form-control bg-dark text-light border-light"
                required
              />
            </div>
            <div class="col-md-3 text-end">
              <button type="submit" class="btn btn-primary w-100">
                + Add Task
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Task List -->
      <div th:if="${tasks.empty}" class="alert alert-info text-center">
        ðŸŽ‰ No tasks pending today!
      </div>

      <div th:unless="${tasks.empty}" class="table-responsive shadow-lg">
        <table class="table table-dark table-hover align-middle mb-0">
          <thead class="table-light text-dark">
            <tr>
              <th>#</th>
              <th>Content</th>
              <th>Link</th>
              <th>Date</th>
              <th>Status</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="task,iterStat : ${tasks}">
              <td th:text="${iterStat.count}"></td>
              <td th:text="${task.content}"></td>
              <td>
                <a target="_blank" th:href="${task.link}">Link</a>
              </td>
              <td th:text="${task.date}"></td>
              <td>
                <span th:if="${!task.isDone}" class="badge bg-warning text-dark"
                  >Pending</span
                >
                <span th:if="${task.isDone}" class="badge bg-success"
                  >Done</span
                >
              </td>
              <td class="text-center">
                <!-- Toggle status -->
                <form
                  th:action="@{/tasks/toggleStatus/{id}(id=${task.id})}"
                  method="post"
                  class="d-inline"
                >
                  <button
                    type="submit"
                    th:classappend="${task.isDone} ? 'btn btn-sm btn-secondary' : 'btn btn-sm btn-success'"
                  >
                    <span
                      th:text="${task.isDone} ? 'Mark Pending' : 'Mark Done'"
                    ></span>
                  </button>
                </form>
                <!-- Delete task -->
                <form
                  th:action="@{/tasks/delete/{id}(id=${task.id})}"
                  method="post"
                  class="d-inline"
                >
                  <button type="submit" class="btn btn-sm btn-danger ms-2">
                    Delete
                  </button>
                </form>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>
